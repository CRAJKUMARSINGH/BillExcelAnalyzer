
✅ App Overview
•	The app prepares a contractor bill for infrastructure projects based on input Excel sheets containing item rates and quantity executed.
•	It is Streamlit-based Python code designed for instantaneous bill preparation and printing, solving the headache of Excel page setups.
•	The target audience is a personal team limited to 5 users.
•	Your goals include:
o	Better performance
o	Elegant page setup

✅ Core Requirements in Chronological Development Order
1. Net Payable Calculation
•	Add a computation that takes the last bill paid amount as input and deduces the net payable amount for the current bill.

2. Final vs Non-Final Bill Handling
Determine Final Bills
•	A bill is considered final if the “Actual date of completion” (from Work Order or Title sheet) is a valid date.
•	If not (e.g., missing or marked “Work in Progress”), it’s treated as non-final.
For Final Bills
•	Show the Actual date of completion as entered.
•	Include the Deviation Statement in the output (PDF/Word).
•	Evaluate and print delay assessment in the note sheet.
For Non-Final Bills
•	Set the “Actual date of completion” to “Work in Progress” by default.
•	Skip delay assessment.
•	Replace all time-related notes with a single line: “Work in Progress.”

3. Dynamic Row Handling in Excel Inputs
•	Enhance the app to robustly detect data row start position dynamically.
•	The app should not break if a user inputs data starting from a row other than the default (above or below).

4. Conditional Item Visibility in Bills
General Rule
•	Only print items (and sub-items/sub-sub-items) that have non-zero quantity in the current bill.
•	Completely skip printing items or hierarchies that are all-zero.
Hierarchical Filtering
•	Both Work Order and Extra Items may have:
o	Main Items (e.g., 17)
	Sub-items (e.g., a, b, c)
	Sub-sub-items (e.g., i, ii, iii)
Requirement
•	If only a deeply nested sub-sub-item (e.g., 17 a (iii)) has non-zero quantity:
o	Only that specific item should be printed in the bill and deviation statement.
o	All other sibling items/sub-items with zero quantity should be skipped.
o	The printed description should concatenate the hierarchy: e.g., “17 a iii”.

5. Input File Redesign (To Be Detailed Later)
•	You plan to redesign the input Excel file structure.
•	Details will be provided at the appropriate stage of development.

✅ Summary of Technical Tasks
1.	Add net payable calculation from last paid amount.
2.	Implement logic to identify final vs non-final bills and apply appropriate formatting.
3.	Skip delay/time notes and show only “Work in Progress” for non-final bills.
4.	Allow dynamic data row detection in Excel.
5.	Filter and print only non-zero items, handling multi-level hierarchy.
6.	Await further guidance to redesign the input Excel format.

